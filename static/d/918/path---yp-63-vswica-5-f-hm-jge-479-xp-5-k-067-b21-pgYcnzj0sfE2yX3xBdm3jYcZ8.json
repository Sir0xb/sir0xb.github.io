{"data":{"markdownRemark":{"html":"<p>å‰å‡ å¤©è·Ÿè€é“ä»¬èŠå¤©ï¼Œæœ‰ä½è€é“è¯´æƒ³å¼„ä¸€ä¸ªåšå®¢åªé  SEO è¢«æœç´¢ï¼Œæƒ³å†æ¬¡å›å½’æ›¾ç»é‚£ä»½æœ´ç´ ã€‚äºæ˜¯æˆ‘åˆæƒ³èµ·äº†æˆ‘é‚£æ”¾ç½®è®¸ä¹…çš„åšå®¢ã€‚</p>\n<p>é—²èŠä¹‹ä½™ç½‘ä¸Šæ‰¾äº†æ‰¾æœ‰æ²¡æœ‰ä¸é”™çš„é™æ€åšå®¢æ¡†æ¶å¯ç”¨ï¼Œæ¯•ç«Ÿå¥½ä¹…æ²¡æœ‰æ›´æ–°åšå®¢çš„æ¡†æ¶äº†ã€‚\næœºç¼˜å·§åˆï¼Œçœ‹åˆ°çš„æ–‡ç« æ¨èä½¿ç”¨çš„ç¬¬ä¸€é¡¹å°±æ˜¯ <a target=\"_blank\" href=\"https://www.gatsbyjs.org/\">Gatsby</a>ï¼Œä¸Šå®˜ç½‘çœ‹äº†çœ‹è²Œä¼¼è¿˜ä¸é”™ã€‚åæ¥æ‰çŸ¥é“ React å®˜ç½‘ä¹Ÿæ˜¯ç”¨è¿™ä¸ªæ¡†æ¶æ­å»ºçš„ ğŸ˜ã€‚</p>\n<p>æ­£å¥½å¹´å‰æœ‰ç‚¹é—²æš‡æ—¶é—´ï¼Œç€æ‰‹å¼„äº†å¼„ã€‚ä» jekyllã€hexoã€octopressï¼Œç°åœ¨æ›´æ–°åˆ°äº† Gatsbyã€‚ä»¥ä¸‹æ˜¯ä¸€ç‚¹ç‚¹ç»éªŒï¼Œåˆ†äº«ç»™å¤§å®¶ã€‚</p>\n<hr>\n<h2>1. é¡¹ç›®åˆå»º</h2>\n<p>å…ˆå®‰è£…é¡¹ç›®å·¥å…·ï¼š</p>\n<pre><code class=\"language-bash\">npm i -g gatsby-cli\n</code></pre>\n<!--more-->\n<p>ç”Ÿæˆé¡¹ç›®ï¼š</p>\n<pre><code class=\"language-bash\">npm new [your project name]\n</code></pre>\n<p>å¯ä»¥æŸ¥çœ‹ç›®å½•ä¸‹çš„ <code>package.json</code> äº†è§£é¡¹ç›®å‘½ä»¤ã€‚</p>\n<p>è¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå°±èƒ½çœ‹åˆ°é¡¹ç›®å·¥å…·ç”Ÿæˆçš„åŸºç¡€åšå®¢ç«™ã€‚</p>\n<pre><code class=\"language-bash\">gatsby develop\n</code></pre>\n<p>ç®€å•è¯´æ˜ä¸€ä¸‹é¡¹ç›®ç»“æ„ï¼š</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">ç›®å½•/æ–‡ä»¶</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">src/components</td>\n<td>æ”¾ç½®ç»„ä»¶çš„ç›®å½•</td>\n</tr>\n<tr>\n<td align=\"center\">src/pages</td>\n<td>åŸºç¡€æ–¹å¼æ¸²æŸ“çš„é¡µé¢ç›®å½•(æ ¹æ®æ–‡ä»¶åå½¢æˆè·¯ç”±)</td>\n</tr>\n<tr>\n<td align=\"center\">gatsby-config.js</td>\n<td>ä¸­é—´ä»¶é…ç½®åŠç½‘ç«™åŸºæœ¬ä¿¡æ¯é…ç½®æ–‡ä»¶</td>\n</tr>\n<tr>\n<td align=\"center\">gatsby-node.js</td>\n<td>é«˜çº§æ–¹å¼æ¸²æŸ“é¡µé¢(æ ¹æ®è·¯å¾„é…ç½®æ–¹å¼ç”Ÿæˆè·¯ç”±)</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td>&#x3C;ä»¥ä¸‹æ˜¯åç»­æ·»åŠ çš„éƒ¨åˆ†></td>\n</tr>\n<tr>\n<td align=\"center\">src/queries</td>\n<td>Graphql æŸ¥è¯¢è¯­å¥æ”¾ç½®ç›®å½•</td>\n</tr>\n<tr>\n<td align=\"center\">src/templates</td>\n<td>é«˜çº§æ–¹å¼æ¸²æŸ“é¡µé¢æ‰€ç”¨çš„æ¨¡ç‰ˆæ”¾ç½®ç›®å½•</td>\n</tr>\n<tr>\n<td align=\"center\">static</td>\n<td>å‘å¸ƒæ—¶è‡ªåŠ¨åˆå¹¶åˆ°å‘å¸ƒç›®å½•çš„é™æ€æ–‡ä»¶æ”¾ç½®ç›®å½•</td>\n</tr>\n<tr>\n<td align=\"center\">deploy.sh</td>\n<td>æ­£å¼å‘å¸ƒç«™ç‚¹çš„è„šæœ¬</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h2>2. ä¿®æ”¹å¯¼èˆªæ </h2>\n<p>å…ˆæŠŠæ–‡ä»¶ <code>src/components/header</code> è½¬æˆç›®å½• <code>src/components/Header/</code>ã€‚</p>\n<p>å°†åŸæ–‡ä»¶é‡Œçš„ä»£ç æ‹·å…¥ <code>index.jsx</code> å†é€‚å½“çš„ä¿®æ”¹ä¿®æ”¹ã€‚</p>\n<pre><code class=\"language-js\">...\nclass Header extends React.Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            currentMenu: 'home'\n        }\n    }\n\n    componentDidMount() {\n        const { pathname } = window.location\n\n        const extract = pathname.split('/')[1]\n\n        this.setState({ currentMenu: extract === '' ? 'home' : extract })\n\n        if (extract === '' || /^[0-9]+$/.test(extract)) {\n            this.setState({ currentMenu: 'home' })\n        } else if (extract === 'about') {\n            this.setState({ currentMenu: 'about' })\n        } else if (extract === 'blog' || extract.length === 24) {\n            this.setState({ currentMenu: 'blog' })\n        } else {\n            this.setState({ currentMenu: 'null' })\n        }\n    }\n\n    render() {\n        const { siteTitle } = this.props\n        const { currentMenu } = this.state\n\n        return &#x3C;div className=\"header\">\n            &#x3C;div className=\"container\">\n                &#x3C;ul>\n                    &#x3C;li className=\"site-title\">\n                        &#x3C;h1>&#x3C;Link to=\"/\">{siteTitle}&#x3C;/Link>&#x3C;/h1>\n                    &#x3C;/li>\n                    &#x3C;li className={currentMenu === 'home' ? 'menu-item currentMenu' : 'menu-item'}>\n                        &#x3C;h3>&#x3C;Link to=\"/\">Home&#x3C;/Link>&#x3C;/h3>\n                    &#x3C;/li>\n                    &#x3C;li className={currentMenu === 'blog' ? 'menu-item currentMenu' : 'menu-item'}>\n                        &#x3C;h3>&#x3C;Link to=\"/blog\">Blog&#x3C;/Link>&#x3C;/h3>\n                    &#x3C;/li>\n                    &#x3C;li className={currentMenu === 'about' ? 'menu-item currentMenu' : 'menu-item'}>\n                        &#x3C;h3>&#x3C;Link to=\"/about\">About&#x3C;/Link>&#x3C;/h3>\n                    &#x3C;/li>\n                &#x3C;/ul>\n            &#x3C;/div>\n        &#x3C;/div>\n    }\n}\n...\n</code></pre>\n<p>å¢åŠ äº†å½“å‰èœå•çš„ state è¿›è¡Œèœå•çŠ¶æ€ç®¡ç†ã€‚</p>\n<p>ul > li æ¨ªå‘åºåˆ—åŒ–ï¼Œç¬¬ä¸€ä¸ªç”¨ä½œç½‘ç«™æ ‡é¢˜ï¼Œå…¶ä»–çš„ä½œä¸ºèœå•é¡¹ä½¿ç”¨ã€‚</p>\n<p><font color=\"red\">æ³¨ï¼š</font><br>\n<font color=\"red\">1. é¦–é¡µåˆ¤æ–­éƒ¨åˆ†ï¼Œåç»­è¦å¢åŠ é¦–é¡µç¿»é¡µåŠŸèƒ½ï¼Œæ‰€ä»¥å¢åŠ äº†æ•°å­—åˆ¤æ–­ã€‚</font><br>\n<font color=\"red\">2. åšæ–‡åˆ¤æ–­éƒ¨åˆ†ï¼Œå‡†å¤‡ç”¨24ä½éšæœºç ä½œä¸ºæ¯ä¸ªæ–‡ç« çš„åœ°å€ã€‚æ‰€ä»¥é™¤äº† blog è¿˜å¢åŠ äº†éšæœºç é•¿åº¦çš„åˆ¤æ–­ã€‚</font></p>\n<p>æ ·å¼éƒ¨åˆ†å°±æ ¹æ®ä¸ªäººå–œå¥½å¼€å‘å°±å¥½äº†ã€‚</p>\n<hr>\n<h2>3. åšæ–‡åˆ—è¡¨</h2>\n<p>ä½œä¸ºåšå®¢ï¼Œæœ€ä¸»è¦çš„è¿˜æ˜¯åšæ–‡éƒ¨åˆ†ï¼Œå…ˆæŠŠåšæ–‡éƒ¨åˆ†å¼„å‡ºæ¥å†è¯´ã€‚</p>\n<p>ä¹‹å‰çš„åšæ–‡éƒ½æ˜¯ç”¨ markdown å†™çš„ï¼Œå…ˆå®‰è£… markdown è§£æå·¥å…·å¹¶è¿›è¡Œé…ç½®ã€‚</p>\n<pre><code class=\"language-bash\">npm i gatsby-source-filesystem\nnpm i gatsby-transformer-remark\nnpm i gatsby-plugin-catch-links\n</code></pre>\n<p>ä¿®æ”¹ gatsby æ’ä»¶é…ç½® <code>gatsby-config.js</code>:</p>\n<pre><code class=\"language-js\">...\nplugins: [\n...\n{\n    resolve: 'gatsby-source-filesystem',\n    options: {\n        name: 'pages',\n        path: `${__dirname}/src/pages`\n    }\n},\n'gatsby-transformer-remark',\n'gatsby-plugin-catch-links',\n...\n]\n...\n</code></pre>\n<p>é…ç½®å¥½ä¹‹åï¼Œåœ¨ <code>src/pages</code> ç›®å½•é‡Œç›´æ¥åˆ›å»º md æ–‡ä»¶æˆ–æ˜¯åˆ›å»ºç›®å½•å¹¶åœ¨é‡Œè¾¹åˆ›å»º md æ–‡ä»¶éƒ½å¯ä»¥ã€‚markdown è§£æéƒ¨åˆ†å®Œæˆäº†ã€‚</p>\n<p>å¦‚æœç•™æ„è§‚å¯Ÿè¿‡å¯åŠ¨æ—¶æ§åˆ¶å°çš„æç¤ºï¼Œå°±çŸ¥é“è®¿é—® <a target=\"_blank\" href=\"http://localhost:8000/___graphql\"><code>http://localhost:8000/___graphql</code></a> å°±èƒ½å¤Ÿè¿›è¡Œ GraphiQL æŸ¥è¯¢äº†ã€‚</p>\n<p>å…ˆçœ‹ä¸€ä¸‹åšæ–‡å¤´éƒ¨ä¿¡æ¯ï¼š</p>\n<pre><code class=\"language-markdown\">---\npath       : '/yp63Vswica5FHmJGE479XP5k'\ntitle      : 'ç”¨ Gatsby æ­å»ºé™æ€åšå®¢ 1'\ndate       : 2019-01-31 18:56:00  +0800\ncomments   : true\ncategories : programing\nauthor     : Sir0xb\ntags       : [Gatsby, React]\n---\n</code></pre>\n<p>è¿™äº›ä¿¡æ¯å¾ˆé‡è¦ï¼Œéƒ½æ˜¯ä¸€ä¼šå„¿è¦è¢«æŸ¥è¯¢çš„å­—æ®µã€‚</p>\n<p>æ‰“å¼€ <a target=\"_blank\" href=\"http://localhost:8000/___graphql\"><code>http://localhost:8000/___graphql</code></a>ï¼Œåœ¨å·¦ä¾§æœç´¢æ¡ä»¶è¾“å…¥ï¼š</p>\n<pre><code class=\"language-js\">{\n    allMarkdownRemark(sort: {fields: [frontmatter___date], order: DESC}) {\n        edges {\n            node {\n                id\n                html\n                frontmatter {\n                    path\n                    title\n                    date\n                    comments\n                    author\n                    tags\n                }\n                excerpt\n            }\n        }\n    }\n}\n</code></pre>\n<p>çœ‹åˆ°æŸ¥è¯¢ç»“æœå¤§æ¦‚å°±æ˜ç™½å„ä¸ªå­—æ®µä»£è¡¨ä»€ä¹ˆæ„æ€ï¼Œä¸åšè¿‡å¤šè§£é‡Šã€‚</p>\n<p>æœ‰äº†èƒ½å¤Ÿæ­£å¸¸è¿è¡Œçš„æŸ¥è¯¢è¡¨è¾¾å¼ï¼Œå¯ä»¥å¼€å§‹æˆ‘ä»¬çš„æ¸²æŸ“å·¥ä½œäº†ã€‚</p>\n<p>è¿˜è®°å¾—æ”¹é€ èœå•æ—¶å€™æ·»åŠ äº†ä¸€ä¸ªè·¯å¾„ <code>/blog</code> å—ï¼Ÿ\nåœ¨ <code>src/pages</code> é‡Œåˆ›å»ºä¸€ä¸ª <code>blog.js</code></p>\n<pre><code class=\"language-js\">import React from 'react'\nimport { Link, graphql } from 'gatsby'\n\nconst BlogPage = ({ data }) => (\n    &#x3C;div>\n        &#x3C;h1>This is the blog page&#x3C;/h1>\n        {data.allMarkdownRemark.edges.map(post => (\n            &#x3C;div key={ post.node.id }>\n                &#x3C;h3>{post.node.frontmatter.title}&#x3C;/h3>\n                &#x3C;small>Posted by {post.node.frontmatter.author} on {post.node.frontmatter.date}&#x3C;/small>\n                &#x3C;br/>\n                &#x3C;br/>\n                &#x3C;Link to={post.node.frontmatter.path}>Read More&#x3C;/Link>\n                &#x3C;br/>\n                &#x3C;br/>\n                &#x3C;hr/>\n            &#x3C;/div>\n        ))}\n    &#x3C;/div>\n)\n\nexport const pageQuery = graphql`\n    {\n        allMarkdownRemark(sort: {fields: [frontmatter___date], order: DESC}) {\n            edges {\n                node {\n                    id\n                    html\n                    frontmatter {\n                        path\n                        title\n                        date\n                        comments\n                        author\n                        tags\n                    }\n                    excerpt\n                }\n            }\n        }\n    }\n`\n\nexport default BlogPage\n</code></pre>\n<p>Gatsby ç”¨ GraphiQL æŸ¥è¯¢æ–‡ä»¶çš„é€»è¾‘å°±æ˜¯ï¼Œé€šè¿‡å¯¼å‡º pageQuery è¿›è¡Œæ•°æ®æŸ¥è¯¢ï¼Œå¹¶æŠŠç»“æœæ³¨å…¥åˆ°å½“å‰ Component çš„ props çš„ data é‡Œã€‚</p>\n<p>é‡æ–°å¯åŠ¨ä¹‹åï¼Œç‚¹å‡»èœå• <code>blog</code> çœ‹åˆ°æ‰€æœ‰æ–‡ç« åˆ—è¡¨äº†ã€‚</p>\n<hr>\n<h2>4. åšæ–‡é¢„è§ˆ</h2>\n<p>ç‚¹å‡»åšæ–‡å‘ç°é¡µé¢ 404 äº†ã€‚åŸå› æ˜¯åœ¨ <code>src/pages</code> é‡Œæ²¡æœ‰æ‰¾åˆ°æˆ‘ä»¬24ä½éšæœºç è·¯å¾„å¯¹åº”çš„æ–‡ä»¶ã€‚</p>\n<p>è¿™æ—¶å€™æˆ‘ä»¬å°±è¦ç”¨åˆ°é«˜çº§æ–¹å¼æ¸²æŸ“é¡µé¢çš„åŠŸèƒ½äº†ã€‚</p>\n<p>æˆ‘ä»¬å…ˆåšä¸€ä¸ªåšæ–‡é¢„è§ˆçš„æ¨¡ç‰ˆæ–‡ä»¶ <code>src/templates/post.js</code></p>\n<pre><code class=\"language-js\">import React from 'react'\nimport { graphql } from 'gatsby'\n\nimport Layout from '../components/layout'\nimport SEO from '../components/seo'\n\nimport './style.css'\n\nconst Template = ({ data }) => {\n    const post = data.markdownRemark\n\n    return &#x3C;Layout>\n        &#x3C;SEO title={post.frontmatter.title} />\n        &#x3C;button\n            className=\"go-back\"\n            onClick={() => { window.history.back() }}\n        >Go back&#x3C;/button>\n        &#x3C;div className=\"blog-post\">\n            &#x3C;h1>{post.frontmatter.title}&#x3C;/h1>\n            &#x3C;h4>Posted by {post.frontmatter.author} on {post.frontmatter.date}&#x3C;/h4>\n            &#x3C;div dangerouslySetInnerHTML={{__html: post.html}}>&#x3C;/div>\n        &#x3C;/div>\n    &#x3C;/Layout>\n}\n\nexport const postQuery = graphql`\n    query BlogxxxPostByPath($path: String!) {\n        markdownRemark(frontmatter: { path: { eq: $path } }) {\n            html\n            frontmatter {\n                path\n                title\n                author\n                date\n            }\n        }\n    }\n`\n\nexport default Template\n</code></pre>\n<p>æˆ‘ä»¬æŠŠ <code>blog.js</code> é‡Œé¢çš„æŸ¥è¯¢æŠ½ç¦»åˆ° <code>src/queries/queryAll.js</code> é‡Œã€‚\n<code>blog.js</code> æ–‡ä»¶é‡Œçš„æŸ¥è¯¢å…ˆä¸åŠ¨ã€‚(<code>blog.js</code> æ–‡ä»¶åç»­å°±æ”¾å¼ƒä¸ç”¨äº†)</p>\n<p>æ‰“å¼€ <code>gatsby-node.js</code> æ–‡ä»¶ã€‚</p>\n<pre><code class=\"language-js\">const path = require('path')\n\nconst queryAll = require('./src/queries/queryAll')\n\nexports.createPages = ({ boundActionCreators, graphql }) => {\n    const { createPage } = boundActionCreators\n\n    return new Promise((resolve, reject) => {\n        resolve(\n            graphql(queryAll).then(result => {\n                if (result.errors) reject(result.errors)\n\n                // æ ¹æ®æ–‡ç« IDç”Ÿæˆé¡µé¢\n                const postTemplate = path.resolve('./src/templates/post.js')\n                result.data.allMarkdownRemark.edges.forEach(({ node }) => {\n                    createPage({\n                        path      : node.frontmatter.path,\n                        component : postTemplate\n                    })\n                })\n            })\n        )\n    })\n}\n</code></pre>\n<p>é‡å¯ä¹‹åå†ç‚¹å¼€æ–‡ç« ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥æ­£å¸¸æ¸²æŸ“äº†ã€‚</p>\n<hr>\n<h2>5. å¢åŠ ç¿»é¡µå™¨</h2>\n<p>å†™äº†å¤šå¹´çš„åšå®¢é‚£ä¹ˆå¤šçš„åšæ–‡ï¼Œå¦‚æœä¸€æ¬¡æ€§å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥å°±ä¸å‹å¥½äº†ã€‚</p>\n<p>è§£å†³æ–¹æ¡ˆå°±æ˜¯åŠ ä¸ªç¿»é¡µå™¨ï¼Œå…ˆæŠŠ gatsby çš„ç¿»é¡µå™¨å·¥å…·å®‰ä¸Šã€‚</p>\n<pre><code class=\"language-bash\">npm i gatsby-paginate\n</code></pre>\n<p>ç¿»é¡µå™¨åŠŸèƒ½å¯ä»¥ä½¿ç”¨å®˜ç½‘ <a target=\"_blank\" href=\"https://www.gatsbyjs.org/packages/gatsby-paginate/?=gatsby-paginate#create-the-template\">Demo</a> é‡Œæä¾›çš„ä»£ç ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è‡ªå·±å¼€å‘ã€‚</p>\n<p>æˆ‘æ¯”è¾ƒå–œæ¬¢å‰åéƒ½æœ‰ã€Šæœ€å‰ã€‹ã€ã€Šæœ€åã€‹ä»¥åŠã€Šä¸Šä¸€é¡µã€‹ã€ã€Šä¸‹ä¸€é¡µã€‹æŒ‰é’®ï¼Œé¡µç éƒ¨åˆ†ä½ä½è‡³å°‘ç•™æœ‰ä¸¤ä¸ªé¡µç ï¼Œé«˜ä½ä¹Ÿè‡³å°‘ç•™æœ‰ä¸¤ä¸ªé¡µç ï¼Œå¹¶ä¸”å½“å‰é¡µç çš„å‰åå„ç•™æœ‰ä¸¤ä¸ªé¡µç çš„ç¿»é¡µæ–¹å¼ã€‚</p>\n<p>é‚£æˆ‘ä»¬å…ˆæŠŠç¿»é¡µå™¨ç»„ä»¶å®ç°ä¸€ä¸‹ã€‚<code>src/components/Paginator/index.jsx</code></p>\n<pre><code class=\"language-js\">import React from 'react'\nimport { Link } from 'gatsby'\n\nimport './style.css'\n\nconst getRandomStr = (len = 15) => {\n    let text = ''\n    let possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'\n    for (let i = 0; i &#x3C; len; i++) {\n        text += possible.charAt(Math.floor(Math.random() * possible.length))\n    }\n    return text\n}\n\nconst Paginator = ({ index, pageCount, relativeUrl }) => {\n    let result = []\n\n    result.push(&#x3C;Link key={getRandomStr()} to={relativeUrl}>{'Â«'}&#x3C;/Link>)\n    if (index &#x3C;= 2) {\n        result.push(&#x3C;Link key={getRandomStr()} to={relativeUrl}>{'&#x3C;'}&#x3C;/Link>)\n    } else {\n        result.push(&#x3C;Link key={getRandomStr()} to={`${relativeUrl}/${index - 1}`}>{'&#x3C;'}&#x3C;/Link>)\n    }\n\n    if (pageCount &#x3C; 11) {\n        Object.keys(Array.from({ length: pageCount })).forEach((item, listIndex) => {\n            result.push(\n                &#x3C;Link\n                    key={getRandomStr()}\n                    className={listIndex + 1 === index ? 'currentPage' : ''}\n                    to={`${relativeUrl}/${listIndex === 0 ? '' : listIndex + 1}`}\n                >{listIndex + 1}&#x3C;/Link>\n            )\n        })\n    } else {\n        if (index &#x3C;= 5) {\n            // ä½æ•° index + 2   é«˜ä½ä¸¤ä¸ª\n            Object.keys(Array.from({ length: index + 2 })).forEach((item, listIndex) => {\n                result.push(\n                    &#x3C;Link\n                        key={getRandomStr()}\n                        className={listIndex + 1 === index ? 'currentPage' : ''}\n                        to={`${relativeUrl}/${listIndex === 0 ? '' : listIndex + 1}`}\n                    >{listIndex + 1}&#x3C;/Link>\n                )\n            })\n            result.push(&#x3C;span key={getRandomStr()}>...&#x3C;/span>)\n            result.push(&#x3C;Link key={getRandomStr()} to={`${relativeUrl}/${pageCount - 1}`}>{pageCount - 1}&#x3C;/Link>)\n            result.push(&#x3C;Link key={getRandomStr()} to={`${relativeUrl}/${pageCount}`}>{pageCount}&#x3C;/Link>)\n        } else if (index >= pageCount - 4) {\n            // ä½ä½ä¸¤ä¸ª   é«˜ä½ index - 2 åˆ°é¡¶\n            result.push(&#x3C;Link key={getRandomStr()} to={`${relativeUrl}`}>1&#x3C;/Link>)\n            result.push(&#x3C;Link key={getRandomStr()} to={`${relativeUrl}/2`}>2&#x3C;/Link>)\n            result.push(&#x3C;span key={getRandomStr()}>...&#x3C;/span>)\n            // pageCount - (index - 2) + 1 = pageCount - index + 3\n            Object.keys(Array.from({ length: pageCount - index + 3  })).forEach((item, listIndex) => {\n                let newIndex = listIndex + index - 3\n                result.push(\n                    &#x3C;Link\n                        key={getRandomStr()}\n                        className={newIndex + 1 === index ? 'currentPage' : ''}\n                        to={`${relativeUrl}/${newIndex === 0 ? '' : newIndex + 1}`}\n                    >{newIndex + 1}&#x3C;/Link>\n                )\n            })\n        } else {\n            // ä½ä½ä¸¤ä¸ª  ä¸­é—´ index - 2 ~ index + 2  é«˜ä½ä¸¤ä¸ª\n            result.push(&#x3C;Link key={getRandomStr()} to={`${relativeUrl}`}>1&#x3C;/Link>)\n            result.push(&#x3C;Link key={getRandomStr()} to={`${relativeUrl}/2`}>2&#x3C;/Link>)\n            result.push(&#x3C;span key={getRandomStr()}>...&#x3C;/span>)\n            result.push(&#x3C;Link key={getRandomStr()} to={`${relativeUrl}/${index - 2}`}>{index - 2}&#x3C;/Link>)\n            result.push(&#x3C;Link key={getRandomStr()} to={`${relativeUrl}/${index - 1}`}>{index - 1}&#x3C;/Link>)\n            result.push(&#x3C;Link key={getRandomStr()} className=\"currentPage\" to={`${relativeUrl}/${index}`}>{index}&#x3C;/Link>)\n            result.push(&#x3C;Link key={getRandomStr()} to={`${relativeUrl}/${index + 1}`}>{index + 1}&#x3C;/Link>)\n            result.push(&#x3C;Link key={getRandomStr()} to={`${relativeUrl}/${index + 2}`}>{index + 2}&#x3C;/Link>)\n            result.push(&#x3C;span key={getRandomStr()}>...&#x3C;/span>)\n            result.push(&#x3C;Link key={getRandomStr()} to={`${relativeUrl}/${pageCount - 1}`}>{pageCount - 1}&#x3C;/Link>)\n            result.push(&#x3C;Link key={getRandomStr()} to={`${relativeUrl}/${pageCount}`}>{pageCount}&#x3C;/Link>)\n        }\n    }\n\n    if (index === pageCount) {\n        result.push(&#x3C;Link key={getRandomStr()} to={`${relativeUrl}/${pageCount}`}>{'>'}&#x3C;/Link>)\n    } else {\n        result.push(&#x3C;Link key={getRandomStr()} to={`${relativeUrl}/${index + 1}`}>{'>'}&#x3C;/Link>)\n    }\n    result.push(&#x3C;Link key={getRandomStr()} to={`${relativeUrl}/${pageCount}`}>{'Â»'}&#x3C;/Link>)\n\n    return &#x3C;div className=\"paginator\">\n        {result}\n    &#x3C;/div>\n}\n\nexport default Paginator\n</code></pre>\n<p><font color=\"red\">æ³¨ï¼šå› ä¸ºç¿»é¡µå™¨å¯èƒ½ä¼šç”¨åœ¨é¦–é¡µï¼Œä¹Ÿå¯èƒ½ç”¨åœ¨åšæ–‡é¡µï¼Œæ‰€ä»¥ä¼ å…¥äº†ç›¸å¯¹è·¯å¾„ <code>relativeUrl</code>ã€‚</font></p>\n<p>å°† <code>src/pages/blog.js</code> æ›´åæˆ–åˆ é™¤ã€‚æˆ‘ä»¬è¦é€šè¿‡é«˜çº§æ–¹å¼ç”Ÿæˆåšæ–‡é¡µé¢ï¼Œä¸å†ä½¿ç”¨åŸæ¥çš„é¡µé¢äº†ã€‚</p>\n<p>å†åšä¸€ä¸ªå¸¦ç¿»é¡µå™¨çš„åšæ–‡é¡µé¢æ¸²æŸ“æ¨¡ç‰ˆã€‚<code>src/templates/posts.js</code></p>\n<pre><code class=\"language-js\">import React from 'react'\nimport Link from 'gatsby-link'\n\nimport Layout from '../components/layout'\nimport SEO from '../components/seo'\nimport Paginator from '../components/Paginator'\n\nconst Template = ({ pageContext }) => {\n    const {\n        group,\n        index,\n        pageCount\n    } = pageContext\n\n    return &#x3C;Layout>\n        &#x3C;SEO title=\"Blog\" />\n        &#x3C;Paginator index={index} pageCount={pageCount} relativeUrl=\"/blog\" />\n        {group.map(({ node }) => (\n            &#x3C;div className=\"normal-homepage-item\" key={node.id}>\n                &#x3C;h3>{node.frontmatter.title}&#x3C;/h3>\n                &#x3C;small>Posted by {node.frontmatter.author} on {node.frontmatter.date}&#x3C;/small>\n                &#x3C;br/>\n                &#x3C;br/>\n                &#x3C;Link to={node.frontmatter.path}>Read More&#x3C;/Link>\n                &#x3C;br/>\n            &#x3C;/div>\n        ))}\n        &#x3C;Paginator index={index} pageCount={pageCount} relativeUrl=\"/blog\" />\n    &#x3C;/Layout>\n}\n\nexport default Template\n</code></pre>\n<p>æœ‰äº†ç¿»é¡µå™¨ç»„ä»¶ï¼Œæœ‰äº†æ¨¡ç‰ˆï¼Œå°±å·®æ•°æ®äº†ã€‚</p>\n<p>ä¿®æ”¹ä¸‹ <code>gatsby-node.js</code></p>\n<pre><code class=\"language-js\">const path = require('path')\nconst createPaginatedPages = require('gatsby-paginate')\n\nconst queryAll = require('./src/queries/queryAll')\n\nexports.createPages = ({ actions, graphql }) => {\n    const { createPage } = actions\n\n    return new Promise((resolve, reject) => {\n        resolve(\n            graphql(queryAll).then(result => {\n                if (result.errors) reject(result.errors)\n\n                // ç”Ÿæˆåšæ–‡ç¿»é¡µ\n                const PostsTemplate = path.resolve('./src/templates/posts.js')\n                createPaginatedPages({\n                    edges        : result.data.allMarkdownRemark.edges,\n                    createPage   : createPage,\n                    pageTemplate : PostsTemplate,\n                    pageLength   : 10,\n                    pathPrefix   : 'blog'\n                })\n\n                // æ ¹æ®æ–‡ç« IDç”Ÿæˆé¡µé¢\n                const postTemplate = path.resolve('./src/templates/post.js')\n                result.data.allMarkdownRemark.edges.forEach(({ node }) => {\n                    createPage({\n                        path      : node.frontmatter.path,\n                        component : postTemplate\n                    })\n                })\n            })\n        )\n    })\n}\n</code></pre>\n<p><font color=\"red\">æ³¨ï¼šç”±äº <code>gatsby-paginate</code> è¦æ±‚çš„ Gatsby ç‰ˆæœ¬è¦æ¯”é»˜è®¤çš„é«˜ï¼Œæ‰€ä»¥æˆ‘æŠŠ Gatsby ç‰ˆæœ¬å‡çº§åˆ°äº†æœ€é«˜ã€‚äºæ˜¯è¿™é‡Œæœ‰äº†ç‚¹å˜åŒ–ã€‚åŸå…ˆçš„ <code>boundActionCreators</code> å˜æˆäº† <code>actions</code>ã€‚</font></p>\n<hr>\n<h4>- THE END -</h4>","frontmatter":{"path":"/yp63Vswica5FHmJGE479XP5k","title":"ç”¨ Gatsby æ­å»ºé™æ€åšå®¢ 1","author":"Sir0xb","date":"2019-01-31 18:56:00  +0800"}}},"pageContext":{}}
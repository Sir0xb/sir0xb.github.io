{"data":{"markdownRemark":{"html":"<pre><code class=\"language-java\">package com.siro.tools;\n\nimport javax.crypto.Cipher;\nimport javax.crypto.spec.IvParameterSpec;\nimport javax.crypto.spec.SecretKeySpec;\n\nimport sun.misc.BASE64Decoder;\nimport sun.misc.BASE64Encoder;\n\npublic class AESPlus {\n\n    public static String encrypt(String strKey, String strIn) throws Exception {\n        SecretKeySpec skeySpec = getKey(strKey);\n        Cipher cipher = Cipher.getInstance(\"AES/CBC/PKCS5Padding\");\n        IvParameterSpec iv = new IvParameterSpec(\"0102030405060708\".getBytes());\n        cipher.init(Cipher.ENCRYPT_MODE, skeySpec, iv);\n        byte[] encrypted = cipher.doFinal(strIn.getBytes());\n\n        return new BASE64Encoder().encode(encrypted);\n    }\n\n    public static String decrypt(String strKey, String strIn) throws Exception {\n        SecretKeySpec skeySpec = getKey(strKey);\n        Cipher cipher = Cipher.getInstance(\"AES/CBC/PKCS5Padding\");\n        IvParameterSpec iv = new IvParameterSpec(\"0102030405060708\".getBytes());\n        cipher.init(Cipher.DECRYPT_MODE, skeySpec, iv);\n        byte[] encrypted1 = new BASE64Decoder().decodeBuffer(strIn);\n\n        byte[] original = cipher.doFinal(encrypted1);\n        String originalString = new String(original);\n        return originalString;\n    }\n\n    private static SecretKeySpec getKey(String strKey) throws Exception {\n        byte[] arrBTmp = strKey.getBytes();\n        byte[] arrB = new byte[16]; // 创建一个空的16位字节数组（默认值为0）\n\n        for (int i = 0; i &#x3C; arrBTmp.length &#x26;&#x26; i &#x3C; arrB.length; i++) {\n            arrB[i] = arrBTmp[i];\n        }\n\n        SecretKeySpec skeySpec = new SecretKeySpec(arrB, \"AES\");\n\n        return skeySpec;\n    }\n\n    public static void main(String[] args) throws Exception {\n        String Code = \"中文ABc123\";\n        String key = \"1q2w3e4r\";\n        String codE;\n\n        codE = AESPlus.encrypt(key, Code);\n\n        System.out.println(\"原文：\" + Code);\n        System.out.println(\"密钥：\" + key);\n        System.out.println(\"密文：\" + codE);\n        System.out.println(\"解密：\" + AESPlus.decrypt(key, codE));\n    }\n}\n</code></pre>\n<hr>","frontmatter":{"path":"/Aka3bBNuOjmEIVokYkUDQJia","title":"JAVA AES 加密算法","date":"2011-07-29 09:50:04 +0800","comments":true,"categories":"programming","author":"Sir0xb","tags":["java","aes"]}}},"pageContext":{}}
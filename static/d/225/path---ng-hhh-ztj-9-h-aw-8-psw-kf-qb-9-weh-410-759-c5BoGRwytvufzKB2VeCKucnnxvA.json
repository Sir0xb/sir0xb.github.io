{"data":{"markdownRemark":{"html":"<p>以前用 <code>hexo</code> 维护网站的时候评论系统用的是多说，虽然 <code>octopress</code> 自带了一个 <code>disqus</code> 评论系统，不过感觉还是没有多说强大。所以这次改版之后也决定用多说。</p>\n<h2> </h2>\n<h3>添加文章评论</h3>\n<p>在 <code>_config.yml</code> 中找到 <code>disqus</code> 配置</p>\n<pre><code class=\"language-yml\"># Disqus Comments\ndisqus_short_name:\ndisqus_show_comment_count: false\n</code></pre>\n<!--more-->\n<p>在下面添加</p>\n<pre><code class=\"language-yml\">duoshuo_comments: true\nduoshuo_short_name: xxxxxx  # 多说帐号\n</code></pre>\n<p>在 <code>source/_layouts/post.html</code> 中的 <code>disqus</code> 代码</p>\n<p>{% raw %}</p>\n<pre><code class=\"language-html\">{% if site.disqus_short_name and page.comments == true %}\n  &#x3C;section>\n    &#x3C;h1>&#x3C;i class=\"fa fa-comments\">&#x3C;/i> Comments&#x3C;/h1>\n    &#x3C;div id=\"disqus_thread\" aria-live=\"polite\">{% include post/disqus_thread.html %}&#x3C;/div>\n  &#x3C;/section>\n{% endif %}\n</code></pre>\n<p>{% endraw %}</p>\n<p>下面添加多说的模块</p>\n<p>{% raw %}</p>\n<pre><code class=\"language-html\">{% if site.duoshuo_short_name and site.duoshuo_comments == true and page.comments == true %}\n  &#x3C;section>\n    &#x3C;h1>&#x3C;i class=\"fa fa-comments\">&#x3C;/i> Comments&#x3C;/h1>\n    &#x3C;div id=\"comments\" aria-live=\"polite\">{% include post/duoshuo.html %}&#x3C;/div>\n  &#x3C;/section>\n{% endif %}\n</code></pre>\n<p>{% endraw %}</p>\n<p>然后创建上面代码提及的新文件 <code>post/duoshuo.html</code> 具体路径是 <code>source/_includes/post/duoshuo.html</code></p>\n<p>{% raw %}</p>\n<pre><code class=\"language-html\">&#x3C;!-- 多说评论框 start -->\n&#x3C;div class=\"ds-thread\" data-thread-key=\"{% if site.titlecase %}{{ page.title | titlecase }}{% else %}{{ page.title }}{% endif %}\" data-title=\"{% if site.titlecase %}{{ page.title | titlecase }}{% else %}{{ page.title }}{% endif %}\" data-url=\"{{page.previous.url}}\">&#x3C;/div>\n&#x3C;!-- 多说评论框 end -->\n&#x3C;!-- 多说公共JS代码 start (一个网页只需插入一次) -->\n&#x3C;script type=\"text/javascript\">\n    var duoshuoQuery = {short_name:\"{{ site.duoshuo_short_name }}\"};\n    (function() {\n        var ds = document.createElement('script');\n        ds.type = 'text/javascript';ds.async = true;\n        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';\n        ds.charset = 'UTF-8';\n        (document.getElementsByTagName('head')[0]\n         || document.getElementsByTagName('body')[0]).appendChild(ds);\n    })();\n&#x3C;/script>\n&#x3C;!-- 多说公共JS代码 end -->\n</code></pre>\n<p>{% endraw %}</p>\n<h5>* 这里注意一下 <code>data-thread-key</code> 属性，如果不写，控制台会有警告信息。设置成跟 <code>data-title</code> 一样就好。</h5>\n<p>学 <code>disqus</code> 的实现方式，在文章头部也再加个评论按钮。修改 <code>_includes/article.html</code> 文件。</p>\n<p>{% raw %}</p>\n<pre><code class=\"language-html\">{% if site.disqus_short_name and page.comments != false and post.comments != false and site.disqus_show_comment_count == true %}\n   | &#x3C;a href=\"{% if index %}{{ root_url }}{{ post.url }}{% endif %}#disqus_thread\"\n     data-disqus-identifier=\"{% if post.meta.disqus_id %}{{ post.meta.disqus_id }}{% else %}{{ site.url }}{{ post.url }}{% endif %}\">Comments&#x3C;/a>\n{% endif %}\n</code></pre>\n<p>{% endraw %}</p>\n<p>下方添加多说代码部分</p>\n<p>{% raw %}</p>\n<pre><code class=\"language-html\">{% if site.duoshuo_short_name and page.comments != false and post.comments != false and site.duoshuo_comments == true %}\n | &#x3C;a href=\"{% if index %}{{ root_url }}{{ post.url }}{% endif %}#comments\">评论&#x3C;/a>\n{% endif %}\n</code></pre>\n<p>{% endraw %}</p>\n<p>基本功能大功告成</p>\n<h2> </h2>\n<h3>侧边栏现实最新评论</h3>\n<p>在 _config.yml 添加如下配置:</p>\n<pre><code class=\"language-yml\">duoshuo_asides: false       # 是否显示侧边栏\nduoshuo_asides_num: 10      # 侧边栏评论显示条目数\nduoshuo_asides_avatars: 0   # 侧边栏评论是否显示头像\nduoshuo_asides_time: 0      # 侧边栏评论是否显示时间\nduoshuo_asides_title: 0     # 侧边栏评论是否显示标题\nduoshuo_asides_admin: 0     # 侧边栏评论是否显示作者评论\nduoshuo_asides_length: 18   # 侧边栏评论截取的长度\n</code></pre>\n<p>还需要在侧边栏插件文件夹创建评论代码</p>\n<p>{% raw %}</p>\n<pre><code class=\"language-html\">{% if site.duoshuo_asides %}\n&#x3C;section>\n    &#x3C;h1>&#x3C;i class=\"fa fa-comments\">&#x3C;/i> Recent Comments&#x3C;/h1>\n    &#x3C;ul class=\"ds-recent-comments\" data-num-items=\"{{ site.duoshuo_asides_num }}\" data-show-avatars=\"{{ site.duoshuo_asides_avatars }}\" data-show-time=\"{{ site.duoshuo_asides_time }}\" data-show-title=\"{{ site.duoshuo_asides_title }}\" data-show-admin=\"{{ site.duoshuo_asides_admin }}\" data-excerpt-length=\"{{ site.duoshuo_asides_length }}\">&#x3C;/ul>\n    {% if index %}\n    &#x3C;!--多说js加载开始，一个页面只需要加载一次 -->\n    &#x3C;script type=\"text/javascript\">\n      var duoshuoQuery = {short_name:\"{{ site.duoshuo_short_name }}\"};\n      (function() {\n        var ds = document.createElement('script');\n        ds.type = 'text/javascript';ds.async = true;\n        ds.src = 'http://static.duoshuo.com/embed.js';\n        ds.charset = 'UTF-8';\n        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);\n      })();\n    &#x3C;/script>\n    &#x3C;!--多说js加载结束，一个页面只需要加载一次 -->\n    {% endif %}\n&#x3C;/section>\n{% endif %}\n</code></pre>\n<p>{% endraw %}</p>\n<p>如果没有评价，不需要显示孤零零的变迁，可以把 <code>duoshuo_asides</code> 设置成 <code>false</code>。</p>\n<p>最后在 <code>_config.yml</code> 的侧边栏数组中添加页面</p>\n<pre><code class=\"language-yml\">default_asides: [asides/about.html, asides/recent_posts.html, asides/recent_comments.html, asides/links.html, asides/github.html, asides/delicious.html, asides/pinboard.html, asides/googleplus.html]\n</code></pre>\n<p>我选择在最新文章和链接之间显示最新评论。</p>\n<hr>","frontmatter":{"path":"/NgHhhZtj9hAW8PSWKfQB9WEH","title":"Octopress 博客添加多说评论系统","author":"Sir0xb","date":"2016-08-17 20:07:10 +0800"}}},"pageContext":{}}
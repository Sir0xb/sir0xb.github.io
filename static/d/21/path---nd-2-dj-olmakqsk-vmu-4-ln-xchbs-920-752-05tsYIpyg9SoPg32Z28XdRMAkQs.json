{"data":{"markdownRemark":{"html":"<h3>JsonGenerator 生成 JSON</h3>\n<pre><code class=\"language-java\">@RequestMapping(value = \"/json.sir\")\n    public void returnJson(HttpServletRequest request,HttpServletResponse response) throws IOException {\n        String username = request.getParameter(\"username\");\n        String userpass = request.getParameter(\"userpass\");\n\n        Writer out =response.getWriter();\n        ObjectMapper objectMapper = new ObjectMapper();\n        JsonGenerator jsonGenerator = objectMapper.getJsonFactory().createJsonGenerator(out);\n\n        jsonGenerator.writeStartObject();\n        jsonGenerator.writeBooleanField(\"success\", true);\n        jsonGenerator.writeStringField(\"username\", username);\n        jsonGenerator.writeStringField(\"userpass\", userpass);\n        jsonGenerator.writeEndObject();\n        jsonGenerator.flush();\n\n//        jsonGenerator.writeStartObject();\n//        jsonGenerator.writeFieldName(\"callback\");\n//            jsonGenerator.writeStartArray();\n//                jsonGenerator.writeStartObject();\n//                jsonGenerator.writeBooleanField(\"success\", true);\n//                jsonGenerator.writeStringField(\"username\", username);\n//                jsonGenerator.writeStringField(\"userpass\", userpass);\n//                jsonGenerator.writeEndObject();\n//            jsonGenerator.writeEndArray();\n//        jsonGenerator.writeEndObject();\n    }\n</code></pre>\n<h2> </h2>\n<h3>JsonGenerator 生成 JSONP</h3>\n<pre><code class=\"language-java\">@RequestMapping(value = \"jsonp.sir\")\npublic void returnJsonp(HttpServletRequest request,HttpServletResponse response) throws IOException {\n    String username = request.getParameter(\"username\");\n    String userpass = request.getParameter(\"userpass\");\n    String callback = request.getParameter(\"callback\");\n\n    Writer sw = new StringWriter();\n    ObjectMapper objectMapper = new ObjectMapper();\n    JsonGenerator jsonGenerator = objectMapper.getJsonFactory().createJsonGenerator(sw);\n\n    sw.write(callback + \"(\");\n    jsonGenerator.writeStartObject();\n    jsonGenerator.writeBooleanField(\"success\", true);\n    jsonGenerator.writeStringField(\"username\", username);\n    jsonGenerator.writeStringField(\"userpass\", userpass);\n    jsonGenerator.writeEndObject();\n    jsonGenerator.flush();\n    sw.write(\")\");\n    sw.close();\n\n    Writer out =response.getWriter();\n    out.write(sw.toString());\n}\n</code></pre>\n<hr>","frontmatter":{"path":"/Nd2DjOLMAKQSKVmu4LnXCHBS","title":"JsonGenerator 使用","date":"2012-02-28 14:10:22 +0800","comments":true,"categories":"programming","author":"Sir0xb","tags":["java","jsongenerator"]}}},"pageContext":{}}
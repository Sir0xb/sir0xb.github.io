---
path       : '/yp63Vswica5FHmJGE479XP5k'
title      : 'ç”¨ Gatsby æ­å»ºé™æ€åšå®¢ 1'
date       : 2019-01-31 18:56:00 +0800
comments   : true
categories : programming
author     : Sir0xb
tags       : [Gatsby, React]
---

å‰å‡ å¤©è·Ÿè€é“ä»¬èŠå¤©ï¼Œæœ‰ä½è€é“è¯´æƒ³å¼„ä¸€ä¸ªåšå®¢åªé  SEO è¢«æœç´¢ï¼Œæƒ³å†æ¬¡å›å½’æ›¾ç»é‚£ä»½æœ´ç´ ã€‚äºæ˜¯æˆ‘åˆæƒ³èµ·äº†æˆ‘é‚£æ”¾ç½®è®¸ä¹…çš„åšå®¢ã€‚

é—²èŠä¹‹ä½™ç½‘ä¸Šæ‰¾äº†æ‰¾æœ‰æ²¡æœ‰ä¸é”™çš„é™æ€åšå®¢æ¡†æ¶å¯ç”¨ï¼Œæ¯•ç«Ÿå¥½ä¹…æ²¡æœ‰æ›´æ–°åšå®¢çš„æ¡†æ¶äº†ã€‚
æœºç¼˜å·§åˆï¼Œçœ‹åˆ°çš„æ–‡ç« æ¨èä½¿ç”¨çš„ç¬¬ä¸€é¡¹å°±æ˜¯ <a target="_blank" href="https://www.gatsbyjs.org/">Gatsby</a>ï¼Œä¸Šå®˜ç½‘çœ‹äº†çœ‹è²Œä¼¼è¿˜ä¸é”™ã€‚åæ¥æ‰çŸ¥é“ React å®˜ç½‘ä¹Ÿæ˜¯ç”¨è¿™ä¸ªæ¡†æ¶æ­å»ºçš„ ğŸ˜ã€‚

æ­£å¥½å¹´å‰æœ‰ç‚¹é—²æš‡æ—¶é—´ï¼Œç€æ‰‹å¼„äº†å¼„ã€‚ä» jekyllã€hexoã€octopressï¼Œç°åœ¨æ›´æ–°åˆ°äº† Gatsbyã€‚ä»¥ä¸‹æ˜¯ä¸€ç‚¹ç‚¹ç»éªŒï¼Œåˆ†äº«ç»™å¤§å®¶ã€‚

***

## 1. é¡¹ç›®åˆå»º

å…ˆå®‰è£…é¡¹ç›®å·¥å…·ï¼š

```bash
npm i -g gatsby-cli
```

<!--more-->

ç”Ÿæˆé¡¹ç›®ï¼š

```bash
npm new [your project name]
```

å¯ä»¥æŸ¥çœ‹ç›®å½•ä¸‹çš„ `package.json` äº†è§£é¡¹ç›®å‘½ä»¤ã€‚

è¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå°±èƒ½çœ‹åˆ°é¡¹ç›®å·¥å…·ç”Ÿæˆçš„åŸºç¡€åšå®¢ç«™ã€‚

```bash
gatsby develop
```

ç®€å•è¯´æ˜ä¸€ä¸‹é¡¹ç›®ç»“æ„ï¼š

| ç›®å½•/æ–‡ä»¶ | è¯´æ˜ |
| :---: | --- |
| src/components | æ”¾ç½®ç»„ä»¶çš„ç›®å½• |
| src/pages | åŸºç¡€æ–¹å¼æ¸²æŸ“çš„é¡µé¢ç›®å½•(æ ¹æ®æ–‡ä»¶åå½¢æˆè·¯ç”±) |
| gatsby-config.js | ä¸­é—´ä»¶é…ç½®åŠç½‘ç«™åŸºæœ¬ä¿¡æ¯é…ç½®æ–‡ä»¶ |
| gatsby-node.js | é«˜çº§æ–¹å¼æ¸²æŸ“é¡µé¢(æ ¹æ®è·¯å¾„é…ç½®æ–¹å¼ç”Ÿæˆè·¯ç”±) |
||<ä»¥ä¸‹æ˜¯åç»­æ·»åŠ çš„éƒ¨åˆ†>|
| src/queries | Graphql æŸ¥è¯¢è¯­å¥æ”¾ç½®ç›®å½• |
| src/templates | é«˜çº§æ–¹å¼æ¸²æŸ“é¡µé¢æ‰€ç”¨çš„æ¨¡ç‰ˆæ”¾ç½®ç›®å½• |
| static | å‘å¸ƒæ—¶è‡ªåŠ¨åˆå¹¶åˆ°å‘å¸ƒç›®å½•çš„é™æ€æ–‡ä»¶æ”¾ç½®ç›®å½• |
| deploy.sh | æ­£å¼å‘å¸ƒç«™ç‚¹çš„è„šæœ¬ |

***

## 2. ä¿®æ”¹å¯¼èˆªæ 

å…ˆæŠŠæ–‡ä»¶ `src/components/header` è½¬æˆç›®å½• `src/components/Header/`ã€‚

å°†åŸæ–‡ä»¶é‡Œçš„ä»£ç æ‹·å…¥ `index.jsx` å†é€‚å½“çš„ä¿®æ”¹ä¿®æ”¹ã€‚

```javascript
...
class Header extends React.Component {
	constructor(props) {
		super(props)

		this.state = {
			currentMenu: 'home'
		}
	}

	componentDidMount() {
		const { pathname } = window.location

		const extract = pathname.split('/')[1]

		this.setState({ currentMenu: extract === '' ? 'home' : extract })

		if (extract === '' || /^[0-9]+$/.test(extract)) {
			this.setState({ currentMenu: 'home' })
		} else if (extract === 'about') {
			this.setState({ currentMenu: 'about' })
		} else if (extract === 'blog' || extract.length === 24) {
			this.setState({ currentMenu: 'blog' })
		} else {
			this.setState({ currentMenu: 'null' })
		}
	}

	render() {
		const { siteTitle } = this.props
		const { currentMenu } = this.state

		return <div className="header">
			<div className="container">
				<ul>
					<li className="site-title">
						<h1><Link to="/">{siteTitle}</Link></h1>
					</li>
					<li className={currentMenu === 'home' ? 'menu-item currentMenu' : 'menu-item'}>
						<h3><Link to="/">Home</Link></h3>
					</li>
					<li className={currentMenu === 'blog' ? 'menu-item currentMenu' : 'menu-item'}>
						<h3><Link to="/blog">Blog</Link></h3>
					</li>
					<li className={currentMenu === 'about' ? 'menu-item currentMenu' : 'menu-item'}>
						<h3><Link to="/about">About</Link></h3>
					</li>
				</ul>
			</div>
		</div>
	}
}
...
```

å¢åŠ äº†å½“å‰èœå•çš„ state è¿›è¡Œèœå•çŠ¶æ€ç®¡ç†ã€‚

ul > li æ¨ªå‘åºåˆ—åŒ–ï¼Œç¬¬ä¸€ä¸ªç”¨ä½œç½‘ç«™æ ‡é¢˜ï¼Œå…¶ä»–çš„ä½œä¸ºèœå•é¡¹ä½¿ç”¨ã€‚

<font color="red">æ³¨ï¼š</font><br>
<font color="red">1. é¦–é¡µåˆ¤æ–­éƒ¨åˆ†ï¼Œåç»­è¦å¢åŠ é¦–é¡µç¿»é¡µåŠŸèƒ½ï¼Œæ‰€ä»¥å¢åŠ äº†æ•°å­—åˆ¤æ–­ã€‚</font><br>
<font color="red">2. åšæ–‡åˆ¤æ–­éƒ¨åˆ†ï¼Œå‡†å¤‡ç”¨24ä½éšæœºç ä½œä¸ºæ¯ä¸ªæ–‡ç« çš„åœ°å€ã€‚æ‰€ä»¥é™¤äº† blog è¿˜å¢åŠ äº†éšæœºç é•¿åº¦çš„åˆ¤æ–­ã€‚</font>

æ ·å¼éƒ¨åˆ†å°±æ ¹æ®ä¸ªäººå–œå¥½å¼€å‘å°±å¥½äº†ã€‚

***

## 3. åšæ–‡åˆ—è¡¨

ä½œä¸ºåšå®¢ï¼Œæœ€ä¸»è¦çš„è¿˜æ˜¯åšæ–‡éƒ¨åˆ†ï¼Œå…ˆæŠŠåšæ–‡éƒ¨åˆ†å¼„å‡ºæ¥å†è¯´ã€‚

ä¹‹å‰çš„åšæ–‡éƒ½æ˜¯ç”¨ markdown å†™çš„ï¼Œå…ˆå®‰è£… markdown è§£æå·¥å…·å¹¶è¿›è¡Œé…ç½®ã€‚

```bash
npm i gatsby-source-filesystem
npm i gatsby-transformer-remark
npm i gatsby-plugin-catch-links
```

ä¿®æ”¹ gatsby æ’ä»¶é…ç½® `gatsby-config.js`:

```javascript
...
plugins: [
...
{
	resolve: 'gatsby-source-filesystem',
	options: {
		name: 'pages',
		path: `${__dirname}/src/pages`
	}
},
'gatsby-transformer-remark',
'gatsby-plugin-catch-links',
...
]
...
```

é…ç½®å¥½ä¹‹åï¼Œåœ¨ `src/pages` ç›®å½•é‡Œç›´æ¥åˆ›å»º md æ–‡ä»¶æˆ–æ˜¯åˆ›å»ºç›®å½•å¹¶åœ¨é‡Œè¾¹åˆ›å»º md æ–‡ä»¶éƒ½å¯ä»¥ã€‚markdown è§£æéƒ¨åˆ†å®Œæˆäº†ã€‚

å¦‚æœç•™æ„è§‚å¯Ÿè¿‡å¯åŠ¨æ—¶æ§åˆ¶å°çš„æç¤ºï¼Œå°±çŸ¥é“è®¿é—® <a target="_blank" href="http://localhost:8000/___graphql">`http://localhost:8000/___graphql`</a> å°±èƒ½å¤Ÿè¿›è¡Œ GraphiQL æŸ¥è¯¢äº†ã€‚

å…ˆçœ‹ä¸€ä¸‹åšæ–‡å¤´éƒ¨ä¿¡æ¯ï¼š

```markdown
---
path       : '/yp63Vswica5FHmJGE479XP5k'
title      : 'ç”¨ Gatsby æ­å»ºé™æ€åšå®¢ 1'
date       : 2019-01-31 18:56:00  +0800
comments   : true
categories : programming
author     : Sir0xb
tags       : [Gatsby, React]
---
```
è¿™äº›ä¿¡æ¯å¾ˆé‡è¦ï¼Œéƒ½æ˜¯ä¸€ä¼šå„¿è¦è¢«æŸ¥è¯¢çš„å­—æ®µã€‚

æ‰“å¼€ <a target="_blank" href="http://localhost:8000/___graphql">`http://localhost:8000/___graphql`</a>ï¼Œåœ¨å·¦ä¾§æœç´¢æ¡ä»¶è¾“å…¥ï¼š

```javascript
{
	allMarkdownRemark(sort: {fields: [frontmatter___date], order: DESC}) {
		edges {
			node {
				id
				html
				frontmatter {
					path
					title
					date
					comments
					author
					tags
				}
				excerpt
			}
		}
	}
}
```

çœ‹åˆ°æŸ¥è¯¢ç»“æœå¤§æ¦‚å°±æ˜ç™½å„ä¸ªå­—æ®µä»£è¡¨ä»€ä¹ˆæ„æ€ï¼Œä¸åšè¿‡å¤šè§£é‡Šã€‚

æœ‰äº†èƒ½å¤Ÿæ­£å¸¸è¿è¡Œçš„æŸ¥è¯¢è¡¨è¾¾å¼ï¼Œå¯ä»¥å¼€å§‹æˆ‘ä»¬çš„æ¸²æŸ“å·¥ä½œäº†ã€‚

è¿˜è®°å¾—æ”¹é€ èœå•æ—¶å€™æ·»åŠ äº†ä¸€ä¸ªè·¯å¾„ `/blog` å—ï¼Ÿ
åœ¨ `src/pages` é‡Œåˆ›å»ºä¸€ä¸ª `blog.js`

```javascript
import React from 'react'
import { Link, graphql } from 'gatsby'

const BlogPage = ({ data }) => (
	<div>
		<h1>This is the blog page</h1>
		{data.allMarkdownRemark.edges.map(post => (
			<div key={ post.node.id }>
				<h3>{post.node.frontmatter.title}</h3>
				<small>Posted by {post.node.frontmatter.author} on {post.node.frontmatter.date}</small>
				<br/>
				<br/>
				<Link to={post.node.frontmatter.path}>Read More</Link>
				<br/>
				<br/>
				<hr/>
			</div>
		))}
	</div>
)

export const pageQuery = graphql`
	{
		allMarkdownRemark(sort: {fields: [frontmatter___date], order: DESC}) {
			edges {
				node {
					id
					html
					frontmatter {
						path
						title
						date
						comments
						author
						tags
					}
					excerpt
				}
			}
		}
	}
`

export default BlogPage
```

Gatsby ç”¨ GraphiQL æŸ¥è¯¢æ–‡ä»¶çš„é€»è¾‘å°±æ˜¯ï¼Œé€šè¿‡å¯¼å‡º pageQuery è¿›è¡Œæ•°æ®æŸ¥è¯¢ï¼Œå¹¶æŠŠç»“æœæ³¨å…¥åˆ°å½“å‰ Component çš„ props çš„ data é‡Œã€‚

é‡æ–°å¯åŠ¨ä¹‹åï¼Œç‚¹å‡»èœå• `blog` çœ‹åˆ°æ‰€æœ‰æ–‡ç« åˆ—è¡¨äº†ã€‚

***

## 4. åšæ–‡é¢„è§ˆ

ç‚¹å‡»åšæ–‡å‘ç°é¡µé¢ 404 äº†ã€‚åŸå› æ˜¯åœ¨ `src/pages` é‡Œæ²¡æœ‰æ‰¾åˆ°æˆ‘ä»¬24ä½éšæœºç è·¯å¾„å¯¹åº”çš„æ–‡ä»¶ã€‚

è¿™æ—¶å€™æˆ‘ä»¬å°±è¦ç”¨åˆ°é«˜çº§æ–¹å¼æ¸²æŸ“é¡µé¢çš„åŠŸèƒ½äº†ã€‚

æˆ‘ä»¬å…ˆåšä¸€ä¸ªåšæ–‡é¢„è§ˆçš„æ¨¡ç‰ˆæ–‡ä»¶ `src/templates/post.js`

```javascript
import React from 'react'
import { graphql } from 'gatsby'

import Layout from '../components/layout'
import SEO from '../components/seo'

import './style.css'

const Template = ({ data }) => {
	const post = data.markdownRemark

	return <Layout>
		<SEO title={post.frontmatter.title} />
		<button
			className="go-back"
			onClick={() => { window.history.back() }}
		>Go back</button>
		<div className="blog-post">
			<h1>{post.frontmatter.title}</h1>
			<h4>Posted by {post.frontmatter.author} on {post.frontmatter.date}</h4>
			<div dangerouslySetInnerHTML={{__html: post.html}}></div>
		</div>
	</Layout>
}

export const postQuery = graphql`
	query BlogxxxPostByPath($path: String!) {
		markdownRemark(frontmatter: { path: { eq: $path } }) {
			html
			frontmatter {
				path
				title
				author
				date
			}
		}
	}
`

export default Template
```

æˆ‘ä»¬æŠŠ `blog.js` é‡Œé¢çš„æŸ¥è¯¢æŠ½ç¦»åˆ° `src/queries/queryAll.js` é‡Œã€‚
`blog.js` æ–‡ä»¶é‡Œçš„æŸ¥è¯¢å…ˆä¸åŠ¨ã€‚(`blog.js` æ–‡ä»¶åç»­å°±æ”¾å¼ƒä¸ç”¨äº†)

æ‰“å¼€ `gatsby-node.js` æ–‡ä»¶ã€‚

```javascript
const path = require('path')

const queryAll = require('./src/queries/queryAll')

exports.createPages = ({ boundActionCreators, graphql }) => {
	const { createPage } = boundActionCreators

	return new Promise((resolve, reject) => {
		resolve(
			graphql(queryAll).then(result => {
				if (result.errors) reject(result.errors)

				// æ ¹æ®æ–‡ç« IDç”Ÿæˆé¡µé¢
				const postTemplate = path.resolve('./src/templates/post.js')
				result.data.allMarkdownRemark.edges.forEach(({ node }) => {
					createPage({
						path      : node.frontmatter.path,
						component : postTemplate
					})
				})
			})
		)
	})
}
```

é‡å¯ä¹‹åå†ç‚¹å¼€æ–‡ç« ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥æ­£å¸¸æ¸²æŸ“äº†ã€‚

***

## 5. å¢åŠ ç¿»é¡µå™¨

å†™äº†å¤šå¹´çš„åšå®¢é‚£ä¹ˆå¤šçš„åšæ–‡ï¼Œå¦‚æœä¸€æ¬¡æ€§å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥å°±ä¸å‹å¥½äº†ã€‚

è§£å†³æ–¹æ¡ˆå°±æ˜¯åŠ ä¸ªç¿»é¡µå™¨ï¼Œå…ˆæŠŠ gatsby çš„ç¿»é¡µå™¨å·¥å…·å®‰ä¸Šã€‚

```bash
npm i gatsby-paginate
```

ç¿»é¡µå™¨åŠŸèƒ½å¯ä»¥ä½¿ç”¨å®˜ç½‘ <a target="_blank" href="https://www.gatsbyjs.org/packages/gatsby-paginate/?=gatsby-paginate#create-the-template">Demo</a> é‡Œæä¾›çš„ä»£ç ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è‡ªå·±å¼€å‘ã€‚

æˆ‘æ¯”è¾ƒå–œæ¬¢å‰åéƒ½æœ‰ã€Šæœ€å‰ã€‹ã€ã€Šæœ€åã€‹ä»¥åŠã€Šä¸Šä¸€é¡µã€‹ã€ã€Šä¸‹ä¸€é¡µã€‹æŒ‰é’®ï¼Œé¡µç éƒ¨åˆ†ä½ä½è‡³å°‘ç•™æœ‰ä¸¤ä¸ªé¡µç ï¼Œé«˜ä½ä¹Ÿè‡³å°‘ç•™æœ‰ä¸¤ä¸ªé¡µç ï¼Œå¹¶ä¸”å½“å‰é¡µç çš„å‰åå„ç•™æœ‰ä¸¤ä¸ªé¡µç çš„ç¿»é¡µæ–¹å¼ã€‚

é‚£æˆ‘ä»¬å…ˆæŠŠç¿»é¡µå™¨ç»„ä»¶å®ç°ä¸€ä¸‹ã€‚`src/components/Paginator/index.jsx`

```javascript
import React from 'react'
import { Link } from 'gatsby'

import './style.css'

const getRandomStr = (len = 15) => {
	let text = ''
	let possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'
	for (let i = 0; i < len; i++) {
		text += possible.charAt(Math.floor(Math.random() * possible.length))
	}
	return text
}

const Paginator = ({ index, pageCount, relativeUrl }) => {
	let result = []

	result.push(<Link key={getRandomStr()} to={relativeUrl}>{'Â«'}</Link>)
	if (index <= 2) {
		result.push(<Link key={getRandomStr()} to={relativeUrl}>{'<'}</Link>)
	} else {
		result.push(<Link key={getRandomStr()} to={`${relativeUrl}/${index - 1}`}>{'<'}</Link>)
	}

	if (pageCount < 11) {
		Object.keys(Array.from({ length: pageCount })).forEach((item, listIndex) => {
			result.push(
				<Link
					key={getRandomStr()}
					className={listIndex + 1 === index ? 'currentPage' : ''}
					to={`${relativeUrl}/${listIndex === 0 ? '' : listIndex + 1}`}
				>{listIndex + 1}</Link>
			)
		})
	} else {
		if (index <= 5) {
			// ä½æ•° index + 2   é«˜ä½ä¸¤ä¸ª
			Object.keys(Array.from({ length: index + 2 })).forEach((item, listIndex) => {
				result.push(
					<Link
						key={getRandomStr()}
						className={listIndex + 1 === index ? 'currentPage' : ''}
						to={`${relativeUrl}/${listIndex === 0 ? '' : listIndex + 1}`}
					>{listIndex + 1}</Link>
				)
			})
			result.push(<span key={getRandomStr()}>...</span>)
			result.push(<Link key={getRandomStr()} to={`${relativeUrl}/${pageCount - 1}`}>{pageCount - 1}</Link>)
			result.push(<Link key={getRandomStr()} to={`${relativeUrl}/${pageCount}`}>{pageCount}</Link>)
		} else if (index >= pageCount - 4) {
			// ä½ä½ä¸¤ä¸ª   é«˜ä½ index - 2 åˆ°é¡¶
			result.push(<Link key={getRandomStr()} to={`${relativeUrl}`}>1</Link>)
			result.push(<Link key={getRandomStr()} to={`${relativeUrl}/2`}>2</Link>)
			result.push(<span key={getRandomStr()}>...</span>)
			// pageCount - (index - 2) + 1 = pageCount - index + 3
			Object.keys(Array.from({ length: pageCount - index + 3  })).forEach((item, listIndex) => {
				let newIndex = listIndex + index - 3
				result.push(
					<Link
						key={getRandomStr()}
						className={newIndex + 1 === index ? 'currentPage' : ''}
						to={`${relativeUrl}/${newIndex === 0 ? '' : newIndex + 1}`}
					>{newIndex + 1}</Link>
				)
			})
		} else {
			// ä½ä½ä¸¤ä¸ª  ä¸­é—´ index - 2 ~ index + 2  é«˜ä½ä¸¤ä¸ª
			result.push(<Link key={getRandomStr()} to={`${relativeUrl}`}>1</Link>)
			result.push(<Link key={getRandomStr()} to={`${relativeUrl}/2`}>2</Link>)
			result.push(<span key={getRandomStr()}>...</span>)
			result.push(<Link key={getRandomStr()} to={`${relativeUrl}/${index - 2}`}>{index - 2}</Link>)
			result.push(<Link key={getRandomStr()} to={`${relativeUrl}/${index - 1}`}>{index - 1}</Link>)
			result.push(<Link key={getRandomStr()} className="currentPage" to={`${relativeUrl}/${index}`}>{index}</Link>)
			result.push(<Link key={getRandomStr()} to={`${relativeUrl}/${index + 1}`}>{index + 1}</Link>)
			result.push(<Link key={getRandomStr()} to={`${relativeUrl}/${index + 2}`}>{index + 2}</Link>)
			result.push(<span key={getRandomStr()}>...</span>)
			result.push(<Link key={getRandomStr()} to={`${relativeUrl}/${pageCount - 1}`}>{pageCount - 1}</Link>)
			result.push(<Link key={getRandomStr()} to={`${relativeUrl}/${pageCount}`}>{pageCount}</Link>)
		}
	}

	if (index === pageCount) {
		result.push(<Link key={getRandomStr()} to={`${relativeUrl}/${pageCount}`}>{'>'}</Link>)
	} else {
		result.push(<Link key={getRandomStr()} to={`${relativeUrl}/${index + 1}`}>{'>'}</Link>)
	}
	result.push(<Link key={getRandomStr()} to={`${relativeUrl}/${pageCount}`}>{'Â»'}</Link>)

	return <div className="paginator">
		{result}
	</div>
}

export default Paginator
```

<font color="red">æ³¨ï¼šå› ä¸ºç¿»é¡µå™¨å¯èƒ½ä¼šç”¨åœ¨é¦–é¡µï¼Œä¹Ÿå¯èƒ½ç”¨åœ¨åšæ–‡é¡µï¼Œæ‰€ä»¥ä¼ å…¥äº†ç›¸å¯¹è·¯å¾„ `relativeUrl`ã€‚</font>

å°† `src/pages/blog.js` æ›´åæˆ–åˆ é™¤ã€‚æˆ‘ä»¬è¦é€šè¿‡é«˜çº§æ–¹å¼ç”Ÿæˆåšæ–‡é¡µé¢ï¼Œä¸å†ä½¿ç”¨åŸæ¥çš„é¡µé¢äº†ã€‚

å†åšä¸€ä¸ªå¸¦ç¿»é¡µå™¨çš„åšæ–‡é¡µé¢æ¸²æŸ“æ¨¡ç‰ˆã€‚`src/templates/posts.js`

```javascript
import React from 'react'
import Link from 'gatsby-link'

import Layout from '../components/layout'
import SEO from '../components/seo'
import Paginator from '../components/Paginator'

const Template = ({ pageContext }) => {
	const {
		group,
		index,
		pageCount
	} = pageContext

	return <Layout>
		<SEO title="Blog" />
		<Paginator index={index} pageCount={pageCount} relativeUrl="/blog" />
		{group.map(({ node }) => (
			<div className="normal-homepage-item" key={node.id}>
				<h3>{node.frontmatter.title}</h3>
				<small>Posted by {node.frontmatter.author} on {node.frontmatter.date}</small>
				<br/>
				<br/>
				<Link to={node.frontmatter.path}>Read More</Link>
				<br/>
			</div>
		))}
		<Paginator index={index} pageCount={pageCount} relativeUrl="/blog" />
	</Layout>
}

export default Template
```

æœ‰äº†ç¿»é¡µå™¨ç»„ä»¶ï¼Œæœ‰äº†æ¨¡ç‰ˆï¼Œå°±å·®æ•°æ®äº†ã€‚

ä¿®æ”¹ä¸‹ `gatsby-node.js`

```javascript
const path = require('path')
const createPaginatedPages = require('gatsby-paginate')

const queryAll = require('./src/queries/queryAll')

exports.createPages = ({ actions, graphql }) => {
	const { createPage } = actions

	return new Promise((resolve, reject) => {
		resolve(
			graphql(queryAll).then(result => {
				if (result.errors) reject(result.errors)

				// ç”Ÿæˆåšæ–‡ç¿»é¡µ
				const PostsTemplate = path.resolve('./src/templates/posts.js')
				createPaginatedPages({
					edges        : result.data.allMarkdownRemark.edges,
					createPage   : createPage,
					pageTemplate : PostsTemplate,
					pageLength   : 10,
					pathPrefix   : 'blog'
				})

				// æ ¹æ®æ–‡ç« IDç”Ÿæˆé¡µé¢
				const postTemplate = path.resolve('./src/templates/post.js')
				result.data.allMarkdownRemark.edges.forEach(({ node }) => {
					createPage({
						path      : node.frontmatter.path,
						component : postTemplate
					})
				})
			})
		)
	})
}
```

<font color="red">æ³¨ï¼šç”±äº `gatsby-paginate` è¦æ±‚çš„ Gatsby ç‰ˆæœ¬è¦æ¯”é»˜è®¤çš„é«˜ï¼Œæ‰€ä»¥æˆ‘æŠŠ Gatsby ç‰ˆæœ¬å‡çº§åˆ°äº†æœ€é«˜ã€‚äºæ˜¯è¿™é‡Œæœ‰äº†ç‚¹å˜åŒ–ã€‚åŸå…ˆçš„ `boundActionCreators` å˜æˆäº† `actions`ã€‚</font>

***

#### - THE END -
